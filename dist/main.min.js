function k(a,b){var e=l();e&&(e.open("POST",a,!0),e.setRequestHeader("Content-type","application/json"),e.send(b),e.onreadystatechange=function(){4==e.readyState&&200!=e.status&&201!=e.status&&(Trackets.b.push([a,b]),console.log("Trackets failed to deliver the error report data. Retrying in 20 seconds."))})}var q=[function(){return new XMLHttpRequest},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml3.XMLHTTP")},function(){return new ActiveXObject("Microsoft.XMLHTTP")}];
function l(){for(var a=!1,b=0;b<q.length;b++){try{a=q[b]()}catch(e){continue}break}return a};function r(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}this.key="__trackets_localstorage_guid";this.t=function(){return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()};this.o=function(){if(window.localStorage){var a=window.localStorage.getItem("__trackets_localstorage_guid");a||(a=this.t(),window.localStorage.setItem("__trackets_localstorage_guid",a));return a}}};function s(a){this.key=void 0;this.interval=a||5E3;this.a="undefined"===typeof this.key?[]:JSON.parse(window.localStorage.getItem(void 0))||[];this.push=function(a){this.a.push(a);"undefined"!==typeof this.key&&window.localStorage.setItem(void 0,JSON.stringify(this.a))};this.pop=function(){return this.a.pop()};var b=this,e=new t;e.F(function(){"function"===typeof b.k&&0<b.a.length&&b.k.call(b,b.a.pop())});this.f=function(){e.push("tick")};this.start=function(){b.v=setInterval(function(){e.push("tick")},
b.interval)};this.stop=function(){clearInterval(b.v)}};var v=[/ *(\w+)@(.+):(\d+)/,/ *at (\S+) \((.+?):(\d+):\d+\)/];function w(a){a=a.split("\n");for(var b=[],e=0;e<a.length;e++){var d;a:{d=a[e];for(var f=void 0,g=0;g<v.length;g++)if(f=d.match(v[g])){d=f;break a}d=null}d&&b.push({"function":d[1],file:d[2],line:d[3]})}return b};function t(){this.e=[];this.push=function(a){for(var b=0,e=this.e.length;b<e;b++)this.e[b].call(this,a)};this.F=function(a){this.e.push(a)}};function x(a,b,e){function d(){try{return"string"==typeof a&&(a=new Function(a)),a.apply(this,arguments)}catch(d){if("function"===typeof b)b.call(e||this,d);else throw d;}}if(a.w)return a;d.w=!0;return d}function y(a,b){var e=a.addEventListener,d=a.removeEventListener;a.addEventListener=function(a,g,h){d.call(this,a,g,h);return e.call(this,a,x(g,b),h)};a.removeEventListener=function(a,e,h){d.call(this,a,e,h);return d.call(this,a,x(e,b),h)}}
function z(a){var b=window,e=b.setTimeout,d=b.setInterval;b.setTimeout=function(b,d){return e(x(b,a),d)};b.setInterval=function(b,e){return d(x(b,a),e)}}
function A(a,b){z(a);document.addEventListener("DOMContentLoaded",function(){if(document.addEventListener){y(document,a);y(window,a);y(Element.prototype,a);var b=HTMLButtonElement.prototype.addEventListener;if(b&&/native code/.test(b.toString()))for(var b="HTMLAnchorElement HTMLAppletElement HTMLAreaElement HTMLBaseElement HTMLBaseFontElement HTMLBlockquoteElement HTMLBodyElement HTMLBRElement HTMLButtonElement HTMLDirectoryElement HTMLDivElement HTMLDListElement HTMLFieldSetElement HTMLFontElement HTMLFormElement HTMLFrameElement HTMLFrameSetElement HTMLHeadElement HTMLHeadingElement HTMLHRElement HTMLHtmlElement HTMLIFrameElement HTMLImageElement HTMLInputElement HTMLIsIndexElement HTMLLabelElement HTMLLayerElement HTMLLegendElement HTMLLIElement HTMLLinkElement HTMLMapElement HTMLMenuElement HTMLMetaElement HTMLModElement HTMLObjectElement HTMLOListElement HTMLOptGroupElement HTMLOptionElement HTMLParagraphElement HTMLParamElement HTMLPreElement HTMLQuoteElement HTMLScriptElement HTMLSelectElement HTMLStyleElement HTMLTableCaptionElement HTMLTableCellElement HTMLTableColElement HTMLTableElement HTMLTableRowElement HTMLTableSectionElement HTMLTextAreaElement HTMLTitleElement HTMLUListElement".split(" "),d=
0;d<b.length;d++){var f=b[d];window[f]&&y(window[f].prototype,a)}}});window.onerror=b};"undefined"===typeof goog&&(goog={J:function(){}});
window.Trackets={init:function(a){if(!this.l){a=a||{};this.j(a.api_key,"api_key is required.");this.u=(new r).o();this.d=a.api_key;this.p=a.custom_data||{};this.g=a.callback;this.f=a.tick;this.h=[];document.addEventListener("click",this.r(this));if(a.api_base_url||window.H||a.debug_mode)this.q=!0,this.log("You're running Trackets in development mode. Define `window.__trackets_mock_send_request` to override error reports to production API.");this.B=+new Date;this.n=a.api_base_url||"http://beta.trackets.com";
this.i=this.n+"/reports";this.log("Initialized Trackets with API key:",this.d);A(this.D,this.A);this.b=new s(this.f||2E3);this.b.k=this.G(this);this.b.start();this.l=!0}},D:function(a){window.c=a;throw a;},s:function(){this.b.f()},G:function(a){return function(b){"function"===typeof window.m?window.m(a.i,JSON.parse(b[1])):"boolean"===typeof navigator.onLine?navigator.onLine?k.apply(a,b):Trackets.log("User offline, delaying error request"):k.apply(a,b)}},log:function(){this.q&&console&&console.log&&
console.log.apply(console,arguments)},r:function(a){return function(b){a.h.push({type:"event-click",html:b.target.outerHTML,timestamp:+new Date})}},C:function(a,b,e,d){var f=this.d,g=document.location.href,h=navigator.userAgent;if(d){d=w(d);for(var u=[],n=0;n<d.length;n++){var p=d[n];u.push(p["function"]+" at "+p.file+":"+p.line)}d=u.join("\n")}else d=void 0;a={api_key:f,error:{message:a,file_name:b,line_number:e,url:g,user_agent:h,stacktrace:d,custom_data:this.p,guid:this.u,event_log:this.h,timestamp:(new Date).getTime(),
page_load_timestamp:this.B}};this.g&&this.g.call(this,a.error);return a},notify:function(a,b,e,d){this.j(this.d,"api_key is required");"object"===typeof a&&(d=a,a=w(d.stack),b=a[0].file,e=a[0].I,a=d.message,d=d.stack);data=this.C(a,b,e,d);this.b.push([this.i,JSON.stringify(data)]);this.s()},guard:function(a,b){try{"undefined"===typeof b?a.call(window):a.apply(b,Array.prototype.slice.call(arguments,2))}catch(e){window.Trackets.notify(e)}},guardObject:function(a,b){var e=window.Trackets.notify,d=window.Trackets;
for(key in a)if(a.hasOwnProperty(key)){var f=a[key];"function"!==typeof f||"undefined"!==typeof b&&0!==b.length&&-1==b.indexOf(f.name||key)||(a[key]=x(f,e,d))}},j:function(a,b){if(!a)throw Error("Assertion Error: "+b);},A:function(a,b,e){window.Trackets.notify(window.c&&window.c.message||a,b,e,window.c&&window.c.stack)}};var B=document.querySelector("[data-trackets-key]")||document.querySelector("[data-trackets-customer]"),C;
if(B&&(C=B.attributes["data-trackets-customer"])){var D=window.Trackets;D.init.call(D,{api_key:C.value})};
